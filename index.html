<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>LABORANT.AI2 · IBONARIUM ASSISTANT</title>
<style>
body{margin:0;padding:0;font-family:"Courier New",monospace;background:#000;color:#ffd166;display:flex;justify-content:center;align-items:center;height:100vh;}
.container{width:500px;max-width:90%;height:600px;display:flex;flex-direction:column;background:rgba(0,0,0,.9);border:1px solid #ffd166;padding:20px;box-sizing:border-box;border-radius:10px;}
.header{text-align:center;margin-bottom:10px;font-size:20px;letter-spacing:2px;text-shadow:0 0 10px #ffd166;}
.messages{flex:1;overflow-y:auto;border:1px solid #ffd166;padding:10px;margin-bottom:10px;border-radius:5px;}
.msg{margin-bottom:12px;}
.user{text-align:right;color:#ffe8a3}
.bot{color:#ffd166}
.input-box{display:flex;gap:10px;}
input{flex:1;padding:10px;border:1px solid #ffd166;background:rgba(0,0,0,.5);color:#ffd166;border-radius:5px;}
button{padding:10px 15px;border:1px solid #ffd166;background:rgba(255,209,102,.2);color:#ffd166;cursor:pointer;border-radius:5px;}
</style>
</head>
<body>
<div class="container">
  <div class="header">LABORANT.AI2 · IBONARIUM</div>
  <div class="messages" id="msgs">
    <div class="msg bot">Вітаю! Я laborant.ai2 — асистент Ібонаріуму.<br>Запитайте мене про Ібонаріум, і я покажу уривки з PDF.</div>
  </div>
  <div class="input-box">
    <input id="q" placeholder="Ваше питання…">
    <button onclick="ask()">→</button>
  </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.313/pdf.min.js"></script>
<script>
// ===== PDF у Base64 =====
// ТУТ вставте свій PDF у base64 (для невеликих файлів)
const pdfBase64 = "JVBERi0xLjQKJcTl8uXr...."; // обрізано для прикладу

let pdfText = [];

async function loadPDFBase64(base64){
    const pdfData = atob(base64);
    const pdf = await pdfjsLib.getDocument({data:pdfData}).promise;
    let textItems = [];
    for(let i=1;i<=pdf.numPages;i++){
        const page = await pdf.getPage(i);
        const content = await page.getTextContent();
        content.items.forEach(item=>{
            if(item.str.trim()!=="") textItems.push(item.str.trim());
        });
    }
    pdfText = textItems;
    console.log("PDF завантажено. Рядків:", pdfText.length);
}

loadPDFBase64(pdfBase64);

// ===== CHAT =====
function ask(){
  const v = document.getElementById('q').value.trim();
  if(!v) return;
  add(v, 'user');
  document.getElementById('q').value='';
  setTimeout(()=>add(answer(v),'bot'),200);
}

function add(text,cls){
  const d=document.createElement('div');
  d.className='msg '+cls;
  d.innerHTML=text.replace(/\n/g,'<br>');
  const msgs=document.getElementById('msgs');
  msgs.appendChild(d);
  msgs.scrollTop = msgs.scrollHeight;
}

function answer(m){
  m = m.toLowerCase();
  if(m.includes("ібонаріум") || m.includes("розкажи")){
    if(pdfText.length===0) return "PDF ще завантажується…";
    let res = [];
    const count = Math.floor(Math.random()*3)+2;
    for(let i=0;i<count;i++){
      const r = Math.floor(Math.random()*pdfText.length);
      res.push(pdfText[r]);
    }
    return res.join(' ');
  }
  return "Я асистент Ібонаріуму. Спробуйте запитати про Ібонаріум.";
}

document.getElementById('q').addEventListener('keydown', e=>{
  if(e.key==='Enter') ask();
});
</script>
</body>
</html>
