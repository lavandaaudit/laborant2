<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>LABORANT.AI2 ¬∑ IBONARIUM</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/4.0.379/pdf.min.mjs" type="module"></script>

<style>
*{margin:0;padding:0;box-sizing:border-box}
html,body{width:100%;height:100%;background:#000;color:#ffd166;font-family:"Courier New",monospace;overflow:hidden;}
canvas{position:fixed;inset:0;z-index:0;}
.container{position:relative;z-index:2;height:100vh;display:grid;grid-template-columns:360px 1fr;grid-template-rows:60px 1fr;gap:20px;padding:20px;}
.header{grid-column:1/-1;display:flex;justify-content:space-between;align-items:center;}
.title{font-size:20px;letter-spacing:3px;text-shadow:0 0 20px rgba(255,209,102,.8);}
.status-bar{display:flex;gap:20px;font-size:11px;opacity:.7;}
.dot{width:6px;height:6px;background:#ffd166;border-radius:50%;display:inline-block;margin-right:5px;animation:pulse 1.5s infinite;}
@keyframes pulse{0%,100%{opacity:1}50%{opacity:.3}}
.left-panel{display:flex;flex-direction:column;gap:30px;}
.robot{width:220px;height:220px;position:relative;margin:auto;}
.head{width:130px;height:130px;border:2px solid #ffd166;border-radius:20px;position:absolute;left:50%;transform:translateX(-50%);background:linear-gradient(135deg,rgba(255,209,102,.25),rgba(255,209,102,.05));box-shadow:0 0 35px rgba(255,209,102,.5);animation:float 3s ease-in-out infinite;}
@keyframes float{0%,100%{transform:translate(-50%,0)}50%{transform:translate(-50%,-12px)}}
.eye{width:26px;height:26px;background:#ffd166;border-radius:50%;position:absolute;top:36px;box-shadow:0 0 20px #ffd166;}
.eye.l{left:28px}.eye.r{right:28px}
.mouth{width:60px;height:3px;background:#ffd166;position:absolute;bottom:30px;left:50%;transform:translateX(-50%);}
.body{width:110px;height:80px;border:2px solid #ffd166;border-radius:12px;position:absolute;bottom:0;left:50%;transform:translateX(-50%);background:rgba(255,209,102,.12);box-shadow:0 0 25px rgba(255,209,102,.4);}
.robot-name{text-align:center;letter-spacing:2px;margin-top:10px;}
.robot-title{text-align:center;font-size:11px;opacity:.6;}
.chat{display:flex;flex-direction:column;}
.chat-title{text-align:center;margin-bottom:10px;opacity:.7;}
.messages{flex:1;overflow-y:auto;padding-right:10px;}
.msg{margin-bottom:14px;animation:fade .3s;}
@keyframes fade{from{opacity:0;transform:translateY(6px)}to{opacity:1}}
.user{text-align:right;color:#ffe8a3}
.bot{color:#ffd166}
.input-box{display:flex;gap:10px;}
input{flex:1;background:rgba(40,30,0,.4);border:1px solid rgba(255,209,102,.4);color:#ffd166;padding:10px;}
button{background:rgba(255,209,102,.15);border:1px solid #ffd166;color:#ffd166;padding:10px 18px;cursor:pointer;}
</style>
</head>
<body>

<canvas id="bg"></canvas>

<div class="container">
  <div class="header">
    <div class="title">LABORANT.AI2 ¬∑ IBONARIUM</div>
    <div class="status-bar">
      <span><span class="dot"></span>ONLINE</span>
      <span id="time"></span>
      <span id="state">LOADING...</span>
    </div>
  </div>

  <div class="left-panel">
    <div>
      <div class="robot">
        <div class="head">
          <div class="eye l"></div>
          <div class="eye r"></div>
          <div class="mouth"></div>
        </div>
        <div class="body"></div>
      </div>
      <div class="robot-name">LABORANT.AI2</div>
      <div class="robot-title">ibonarium fragmentor v1.2</div>
    </div>
  </div>

  <div class="chat">
    <div class="chat-title">üí¨ –Ü–ë–û–ù–ê–†–Ü–£–ú ‚Äî –£–†–ò–í–ö–ò</div>
    <div class="messages" id="msgs">
      <div class="msg bot">
        –≤—ñ—Ç–∞—é. —è laborant.ai2 ‚Äî –≤–∏–¥–∞–≤–∞—á —É—Ä–∏–≤–∫—ñ–≤ —ñ–±–æ–Ω–∞—Ä—ñ—É–º—É.<br>
        –∑–∞—Ä–∞–∑ –∑–∞–≤–∞–Ω—Ç–∞–∂—É—é —Ç–µ–∫—Å—Ç –∑ GitHub...<br>
        –∑–∞—á–µ–∫–∞–π 3‚Äì10 —Å–µ–∫—É–Ω–¥
      </div>
    </div>

    <div class="input-box">
      <input id="q" placeholder="—Ä–æ–∑–∫–∞–∂–∏ –ø—Ä–æ —ñ–±–æ–Ω–∞—Ä—ñ—É–º / —â–µ / —É—Ä–∏–≤–æ–∫">
      <button onclick="ask()">‚Üí</button>
    </div>
  </div>
</div>

<script type="module">
// BACKGROUND
const c = document.getElementById("bg"), ctx = c.getContext("2d");
let W, H, particles = [];
function resize() {
  W = c.width = innerWidth;
  H = c.height = innerHeight;
  particles = Array.from({length:120}, ()=>({x:Math.random()*W,y:Math.random()*H,z:Math.random()*W}));
}
resize(); addEventListener("resize", resize);

function drawBg() {
  ctx.fillStyle = "#000"; ctx.fillRect(0,0,W,H);
  ctx.fillStyle = "#ffd166";
  particles.forEach(p => {
    p.z -= 0.4; if (p.z < 1) p.z = W;
    const scale = 120 / p.z;
    const px = (p.x - W/2) * scale + W/2;
    const py = (p.y - H/2) * scale + H/2;
    if (px>0 && py>0 && px<W && py<H) ctx.fillRect(px, py, 1.5, 1.5);
  });
  requestAnimationFrame(drawBg);
}
drawBg();

// TIME
setInterval(() => document.getElementById("time").textContent = new Date().toLocaleTimeString("uk-UA"), 1000);

// PDF & TEXT
import * as pdfjs from "https://cdnjs.cloudflare.com/ajax/libs/pdf.js/4.0.379/pdf.min.mjs";
pdfjs.GlobalWorkerOptions.workerSrc = "https://cdnjs.cloudflare.com/ajax/libs/pdf.js/4.0.379/pdf.worker.min.mjs";

let fragments = [];

async function loadIbonarium() {
  const url = "https://github.com/lavandaaudit/laborant2/raw/main/1.pdf.pdf";
  add("–ó–∞–≤–∞–Ω—Ç–∞–∂—É—é 1.pdf.pdf –∑ GitHub...", "bot");

  try {
    const resp = await fetch(url);
    if (!resp.ok) throw new Error(`HTTP ${resp.status} ‚Äî –º–æ–∂–ª–∏–≤–æ —Ñ–∞–π–ª –≤–∏–¥–∞–ª–µ–Ω–æ –∞–±–æ –ø—Ä–∏–≤–∞—Ç–Ω–∏–π`);
    
    const data = await resp.arrayBuffer();
    const pdf = await pdfjs.getDocument({data}).promise;
    
    let text = "";
    for (let i = 1; i <= pdf.numPages; i++) {
      const page = await pdf.getPage(i);
      const cont = await page.getTextContent();
      cont.items.forEach(item => {
        text += item.str;
        if (item.hasEOL) text += "\n";
      });
      text += "\n\n";
    }

    fragments = text
      .split(/\n\s*\n+/)
      .map(s => s.trim())
      .filter(s => s.length > 30);

    if (fragments.length === 0) {
      add("–¢–µ–∫—Å—Ç –≤–∏—Ç—è–≥–Ω—É—Ç–æ, –∞–ª–µ –Ω–µ–º–∞—î –∑–º—ñ—Å—Ç–æ–≤–Ω–∏—Ö —É—Ä–∏–≤–∫—ñ–≤ (–º–æ–∂–ª–∏–≤–æ —Ç—ñ–ª—å–∫–∏ –∑–∞–≥–æ–ª–æ–≤–∫–∏/—Ç–∞–±–ª–∏—Ü—ñ).", "bot");
    } else {
      document.getElementById("state").textContent = `FRAGMENTS: ${fragments.length}`;
      add(`–ì–æ—Ç–æ–≤–æ. ${fragments.length} —É—Ä–∏–≤–∫—ñ–≤. –ü–∏—à–∏: —â–µ / —Ä–æ–∑–∫–∞–∂–∏ / —ñ–±–æ–Ω–∞—Ä—ñ—É–º`, "bot");
    }
  } catch (e) {
    console.error(e);
    add("–ù–µ –≤–¥–∞–ª–æ—Å—è –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –∞–±–æ —Ä–æ–∑–ø–∞—Ä—Å–∏—Ç–∏ PDF:<br>" + e.message + "<br>–ü–µ—Ä–µ–≤—ñ—Ä –ø–æ—Å–∏–ª–∞–Ω–Ω—è:<br>https://github.com/lavandaaudit/laborant2/raw/main/1.pdf.pdf", "bot");
    document.getElementById("state").textContent = "ERROR";
  }
}

loadIbonarium(); // auto start

// CHAT
function add(msg, cls = "bot") {
  const div = document.createElement("div");
  div.className = `msg ${cls}`;
  div.innerHTML = msg.replace(/\n/g, "<br>");
  document.getElementById("msgs").appendChild(div);
  div.scrollIntoView({behavior: "smooth"});
}

function ask() {
  const input = document.getElementById("q");
  const text = input.value.trim();
  if (!text) return;
  
  add(text, "user");
  input.value = "";
  
  setTimeout(() => {
    add(getResponse(text), "bot");
  }, 400 + Math.random() * 600);
}

function getResponse(q) {
  const low = q.toLowerCase();
  if (low.includes("—ñ–±–æ") || low.includes("—Ä–æ–∑–∫–∞–∂–∏") || low.includes("—â–µ") || low.includes("—É—Ä–∏–≤") || low.includes("—Ñ—Ä–∞–≥–º–µ–Ω—Ç") || low.includes("–∫–∏–Ω—å")) {
    if (fragments.length === 0) {
      return "–¢–µ–∫—Å—Ç —â–µ –Ω–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–∏–≤—Å—è –∞–±–æ –Ω–µ –º—ñ—Å—Ç–∏—Ç—å —É—Ä–∏–≤–∫—ñ–≤.\n–°–ø—Ä–æ–±—É–π –∑–∞ 5‚Äì10 —Å–µ–∫—É–Ω–¥.";
    }
    const idx = Math.floor(Math.random() * fragments.length);
    let frag = fragments[idx];
    if (frag.length > 1000) frag = frag.slice(0, 950) + "‚Ä¶ (–ø—Ä–æ–¥–æ–≤–∂–µ–Ω–Ω—è –≤ –æ—Ä–∏–≥—ñ–Ω–∞–ª—ñ)";
    return frag;
  }
  return "–ü—Ä–æ—Å—Ç–æ –ø–∏—à–∏ —â–æ –∑–∞–≤–≥–æ–¥–Ω–æ –∑ —Å–ª–æ–≤–æ–º ¬´—ñ–±–æ–Ω–∞—Ä—ñ—É–º¬ª, ¬´—Ä–æ–∑–∫–∞–∂–∏¬ª, ¬´—â–µ¬ª, ¬´—É—Ä–∏–≤–æ–∫¬ª ‚Äî –≤–∏–¥–∞–º –≤–∏–ø–∞–¥–∫–æ–≤–∏–π —à–º–∞—Ç–æ–∫ —Ç–µ–∫—Å—Ç—É.";
}

document.getElementById("q").addEventListener("keydown", e => {
  if (e.key === "Enter") ask();
});
</script>
</body>
</html>
